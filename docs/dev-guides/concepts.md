---
sidebar_position: 2
---

import { ProjectName } from '/src/consts';

# 名词概念

**集成**/**设备**/**实体**这3个概念非常重要，是理解{ProjectName}项目的基础，请仔细阅读并且理解。

## 集成
**集成**是{ProjectName}实现设备连接、设备控制、功能拓展的主要途径，它能够使{ProjectName}和其它软件、设备、第三方平台等交互。例如：
* 天气预报集成能够自动识别当前的位置，并且根据当前位置从官方网站获取天气信息。
* 第三方平台集成，能够从第三方接口自动获取设备列表，然后同步到{ProjectName}数据库中，并且能够通过API或者Webhook的方式获取传感器设备的更新。
* 提供相应的请求路径（URL）访问，满足自定义网页中功能的网络请求。
* 集成还有更多功能，但是集成的开发最好遵循[最佳实践](./best-practices.md#integration-dev)。

![Integration Page](/img/integration-page.png)

## 设备
**设备**指物理设备或者逻辑设备。
* 设备由对应的集成负责定义和创建，并且仅能隶属于一个集成
* 设备能否被能手动创建或者删除，由其集成本身定义

![Device List](/img/device-list.png)

* 如果集成可以手动添加设备，那么用户在点击添加按钮后，就可以选择该集成，并填写相应的表单来添加设备。
* 如果集成能够支持手动删除设备，那么用户可以看到列表右侧可以点击的![Device List](/img/DeleteOutlineFilled.svg)。

## 实体
**实体**指具有特定现实意义的对象，是{ProjectName}基本的数据载体。每一个实体都应该预先定义好，事实上集成和设备的功能就是由他们的实体定义的。
* 每个实体属于且仅属于一个**集成**或者一个**设备**。
* 实体的值包括当前值和历史值。
* 共有三种类型：属性实体、事件实体、服务实体
* 实体可以独立存在，也可以存在父子关系。一个父实体可能有多个子实体，但是最多只有两层关系，也就是子实体不能再拥有子实体。

<table>
  <tr>
    <th rowspan="2">实体类型</th>
    <th rowspan="2">解释</th>
    <th colspan="2">当前值</th>
    <th colspan="2">历史值</th>
    <th rowspan="2">举例</th>
  </tr>
  <tr rowspan="2">
    <th>读</th>
    <th>写</th>
    <th>查询</th>
    <th>增加</th>
  </tr>
  <tr>
    <td>属性</td>
    <td>用于存储可保持的**状态**或**参数**信息</td>
    <td>✅</td>
    <td>✅</td>
    <td>✅</td>
    <td>✅</td>
    <td>温度/湿度/距离/ip地址/密钥</td>
  </tr>
  <tr>
    <td>事件</td>
    <td>表示**已发生**的某种重要的**事情**或**动作**</td>
    <td>❌</td>
    <td>❌</td>
    <td>✅</td>
    <td>✅</td>
    <td>
        点击触发/电流达到限额警告/气体浓度超过阈值
    </td>
  </tr>
  <tr>
    <td>服务</td>
    <td>对实体所属对象(设备/集成)**执行操作**</td>
    <td>❌</td>
    <td>❌</td>
    <td>✅执行记录</td>
    <td>✅执行记录</td>
    <td>设备重启/校对时间/阀门开启关闭/连接校验等</td>
  </tr>
</table>

下面我们举个简单的例子来理解集成、设备和实体的关系。

我们为了监控自己房子的电量使用情况，从XXX公司购买了他们的智能开关，并且安装完毕。

开发者（或者XXX公司的工作人员）希望我们的{ProjectName}有能力连接他们的智能开关，因此提供了XXX公司的**集成**。这个**集成**可以用于连接XXX公司的设备。

* 场景1: 在{ProjectName}安装了这个**集成**后，我们可以从集成列表页面看到它。我们现在执行这个集成的“新增设备”，执行它需要输入智能开关的ip地址。
执行成功后，我们就能看到设备列表多了一个智能开关**设备**。
  * 在场景1中，我们看到了两个实体，一个是“新增设备”实体，这是一个**服务类型的实体**。另一个是“ip地址”实体，这个实体是“新增设备”实体的子实体。
* 场景2: 我们还能看到这个集成现在在线的设备数量为1。
  * 在场景2中，我们看到了一个实体“设备数量”，这是一个**属性类型的实体**。
:::tip
场景1和场景2的三个实体都是属于**集成**的实体。
:::
* 场景3: 我们现在可以在{ProjectName}看到这个智能开关设备的电能。
  * 在场景3中，我们看到了一个**属性类型的实体**“电能”。
* 场景4: 我们现在想要重新计算电能，于是执行了这个智能开关设备的“电量清零”。
  * 在场景4中，我们看到了一个**服务类型的实体**“电量清零”，并且这个实体不需要参数，也就是不需要子实体就能够直接执行。
* 场景5: 某一天，这个智能开关控制的某个电器短路了，智能开关跳闸，同时发送了一个跳闸事件。
  * 在场景5中，我们看到了一个**事件类型的实体**“跳闸”。
:::tip
场景3、场景4、场景5中的实体都是**设备**的实体。
:::